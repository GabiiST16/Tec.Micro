
.include "m328pdef.inc"

.CSEG

.ORG 0x0000
RJMP Reset          

Reset:

    LDI R16, LOW(RAMEND)
    OUT SPL, R16
    LDI R16, HIGH(RAMEND)
    OUT SPH, R16

	LDI R16, 0x00
    LDI R16, 0b11111100
    OUT DDRD, R16
	LDI R16, 0b11111100
    OUT DDRD, R16
	LDI R16, 0x00
    LDI R16, 0b00001111
    OUT DDRC, R16
	LDI R16, 0x00
    LDI R16, 0b11111111
    OUT DDRB, R16                 

MainLoop:
	RCALL Cora
    RJMP MainLoop

Caraf:
	LDI R16, 0X00
	LDI R16, 0b00000100
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b11001100
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111100
	OUT PORTC, R16
	//--------
	RCALL Mic
	LDI R16, 0X00
	LDI R16, 0b00001000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00110100
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111011
	OUT PORTC, R16
	RCALL Mic
	//--------
	LDI R16, 0X00
	LDI R16, 0b00010000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00101000
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b0010110
	OUT PORTC, R16
	RCALL Mic
	//-------
	LDI R16, 0X00
	LDI R16, 0b00100000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00111000
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b0010101
	OUT PORTC, R16
	RCALL Mic
	//-----
	LDI R16, 0X00
	LDI R16, 0b01000000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00111000
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b0010101
	OUT PORTC, R16
	RCALL Mic
	//====
	LDI R16, 0X00
	LDI R16, 0b10000000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00101000
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b0010110
	OUT PORTC, R16
	//____
	RCALL Mic
	LDI R16, 0X00
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00110101
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111011
	OUT PORTC, R16
	RCALL Mic
	//___
	LDI R16, 0X00
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00001110
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111100
	OUT PORTC, R16
	RCALL Mic
	RET
Carat:
	LDI R16, 0X00
	LDI R16, 0b00000100
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b11001100
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111100
	OUT PORTC, R16
	RCALL Mic
	//-------
	LDI R16, 0X00
	LDI R16, 0b00001000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00110100
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111011
	OUT PORTC, R16
	RCALL Mic
	//-------
	LDI R16, 0X00
	LDI R16, 0b00010000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00101000
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00110101
	OUT PORTC, R16
	RCALL Mic
	//-------
	LDI R16, 0X00
	LDI R16, 0b00100000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00111000
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00110110
	OUT PORTC, R16
	RCALL Mic
	//------
	LDI R16, 0X00
	LDI R16, 0b01000000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00111000
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00110110
	OUT PORTC, R16
	RCALL Mic
	//-----
	LDI R16, 0X00
	LDI R16, 0b10000000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00101000
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00110101
	OUT PORTC, R16
	RCALL Mic
	//----
	LDI R16, 0X00
	LDI R16, 0b00000000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b00110101
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111011
	OUT PORTC, R16
	RCALL Mic
	//-----
	LDI R16, 0X00
	LDI R16, 0b00000000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b11001110
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111100
	OUT PORTC, R16
	RCALL Mic
	RET
cora:
	LDI R16, 0X00
	LDI R16, 0b00000100
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b11001100
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111110
	OUT PORTC, R16
	RCALL Mic
	//------
	LDI R16, 0X00
	LDI R16, 0b00001000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b11110100
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111101
	OUT PORTC, R16
	RCALL Mic
	//----
	LDI R16, 0X00
	LDI R16, 0b00010000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b11110100
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111011
	OUT PORTC, R16
	RCALL Mic
	//----
	LDI R16, 0X00
	LDI R16, 0b00100000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b11101100
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00110111
	OUT PORTC, R16
	RCALL Mic
	//-----
	LDI R16, 0X00
	LDI R16, 0b01000000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b11101100
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00110111
	OUT PORTC, R16
	RCALL Mic
	//----
	LDI R16, 0X00
	LDI R16, 0b10000000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b11110100
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111011
	OUT PORTC, R16
	RCALL Mic
	//-----
	LDI R16, 0X00
	LDI R16, 0b00000000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b11110101
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111101
	OUT PORTC, R16
	RCALL Mic
	//----
	LDI R16, 0X00
	LDI R16, 0b00000000
	OUT PORTD, R16
	LDI R16, 0X00
	LDI R16, 0b11001110
	OUT PORTB, R16
	LDI R16, 0X00
	LDI R16, 0b00111110
	OUT PORTC, R16
	RCALL Mic
	RET
Mseg:
    LDI R21, 40
    LDI R22, 100
    LDI R23, 189
L1:
    DEC R23
    BRNE L1
    DEC R22
    BRNE L1
    DEC R21
    BRNE L1
    NOP
    RET
Mic:
    LDI R23, 189
L2:
    DEC R23
    BRNE L2
    NOP
    RET
